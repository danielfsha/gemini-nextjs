{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ROG/gemini-nextjs/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\"\r\nimport { twMerge } from \"tailwind-merge\"\r\n\r\nexport function cn(...inputs: ClassValue[]) {\r\n  return twMerge(clsx(inputs))\r\n}\r\n"],"names":[],"mappings":";;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,CAAA,GAAA,2JAAA,CAAA,UAAO,AAAD,EAAE,CAAA,GAAA,qIAAA,CAAA,OAAI,AAAD,EAAE;AACtB"}},
    {"offset": {"line": 25, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ROG/gemini-nextjs/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport { Slot } from \"@radix-ui/react-slot\"\r\nimport { cva, type VariantProps } from \"class-variance-authority\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst buttonVariants = cva(\r\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default:\r\n          \"bg-primary text-primary-foreground shadow hover:bg-primary/90\",\r\n        destructive:\r\n          \"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90\",\r\n        outline:\r\n          \"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground\",\r\n        secondary:\r\n          \"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80\",\r\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\r\n        link: \"text-primary underline-offset-4 hover:underline\",\r\n      },\r\n      size: {\r\n        default: \"h-9 px-4 py-2\",\r\n        sm: \"h-8 rounded-md px-3 text-xs\",\r\n        lg: \"h-10 rounded-md px-8\",\r\n        icon: \"h-9 w-9\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n      size: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nexport interface ButtonProps\r\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\r\n    VariantProps<typeof buttonVariants> {\r\n  asChild?: boolean\r\n}\r\n\r\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\r\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\r\n    const Comp = asChild ? Slot : \"button\"\r\n    return (\r\n      <Comp\r\n        className={cn(buttonVariants({ variant, size, className }))}\r\n        ref={ref}\r\n        {...props}\r\n      />\r\n    )\r\n  }\r\n)\r\nButton.displayName = \"Button\"\r\n\r\nexport { Button, buttonVariants }\r\n"],"names":[],"mappings":";;;;;AAAA;AAEA;AAEA;AAHA;;;;;;AAKA,MAAM,iBAAiB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACvB,ySACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,aACE;YACF,SACE;YACF,WACE;YACF,OAAO;YACP,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AASF,MAAM,uBAAS,sMAAM,UAAU,CAC7B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO,EAAE;IACxD,MAAM,OAAO,UAAU,gKAAA,CAAA,OAAI,GAAG;IAC9B,qBACE,8OAAC;QACC,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EAAE,eAAe;YAAE;YAAS;YAAM;QAAU;QACxD,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,OAAO,WAAW,GAAG"}},
    {"offset": {"line": 85, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ROG/gemini-nextjs/app/services/transcriptionService.ts"],"sourcesContent":["import { GoogleGenerativeAI } from \"@google/generative-ai\";\r\n\r\nconst genAI = new GoogleGenerativeAI(process.env.NEXT_PUBLIC_GEMINI_API_KEY || '');\r\nconst MODEL_NAME = \"gemini-1.5-flash-8b\";\r\n\r\nexport class TranscriptionService {\r\n  private model;\r\n\r\n  constructor() {\r\n    this.model = genAI.getGenerativeModel({ model: MODEL_NAME });\r\n  }\r\n\r\n  async transcribeAudio(audioBase64: string, mimeType: string = \"audio/wav\"): Promise<string> {\r\n    try {\r\n      const result = await this.model.generateContent([\r\n        {\r\n          inlineData: {\r\n            mimeType: mimeType,\r\n            data: audioBase64\r\n          }\r\n        },\r\n        { text: \"Please transcribe the spoken language in this audio accurately. Ignore any background noise or non-speech sounds.\" },\r\n      ]);\r\n\r\n      return result.response.text();\r\n    } catch (error) {\r\n      console.error(\"Transcription error:\", error);\r\n      throw error;\r\n    }\r\n  }\r\n} "],"names":[],"mappings":";;;AAAA;;AAEA,MAAM,QAAQ,IAAI,8JAAA,CAAA,qBAAkB,CAAC,QAAQ,GAAG,CAAC,0BAA0B,IAAI;AAC/E,MAAM,aAAa;AAEZ,MAAM;IACH,MAAM;IAEd,aAAc;QACZ,IAAI,CAAC,KAAK,GAAG,MAAM,kBAAkB,CAAC;YAAE,OAAO;QAAW;IAC5D;IAEA,MAAM,gBAAgB,WAAmB,EAAE,WAAmB,WAAW,EAAmB;QAC1F,IAAI;YACF,MAAM,SAAS,MAAM,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC;gBAC9C;oBACE,YAAY;wBACV,UAAU;wBACV,MAAM;oBACR;gBACF;gBACA;oBAAE,MAAM;gBAAoH;aAC7H;YAED,OAAO,OAAO,QAAQ,CAAC,IAAI;QAC7B,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,wBAAwB;YACtC,MAAM;QACR;IACF;AACF"}},
    {"offset": {"line": 125, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 131, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ROG/gemini-nextjs/app/utils/audioUtils.ts"],"sourcesContent":["// Helper function to download and analyze WAV data\r\nfunction debugSaveWav(wavData: string, filename: string = 'debug.wav') {\r\n  const byteString = atob(wavData);\r\n  const bytes = new Uint8Array(byteString.length);\r\n  for (let i = 0; i < byteString.length; i++) {\r\n    bytes[i] = byteString.charCodeAt(i);\r\n  }\r\n  \r\n  // Create blob and download\r\n  const blob = new Blob([bytes], { type: 'audio/wav' });\r\n  const url = URL.createObjectURL(blob);\r\n  const a = document.createElement('a');\r\n  a.href = url;\r\n  a.download = filename;\r\n  document.body.appendChild(a);\r\n  a.click();\r\n  document.body.removeChild(a);\r\n  URL.revokeObjectURL(url);\r\n}\r\n\r\nexport function pcmToWav(pcmData: string, sampleRate: number = 24000): Promise<string> {\r\n  return new Promise((resolve, reject) => {\r\n    try {\r\n      // Decode base64 PCM data\r\n      const binaryString = atob(pcmData);\r\n      const pcmBytes = new Uint8Array(binaryString.length);\r\n      for (let i = 0; i < binaryString.length; i++) {\r\n        pcmBytes[i] = binaryString.charCodeAt(i);\r\n      }\r\n\r\n      // Convert bytes to samples (assuming 16-bit PCM)\r\n      const samples = new Int16Array(pcmBytes.buffer);\r\n\r\n      // Create WAV header\r\n      const wavHeader = new ArrayBuffer(44);\r\n      const view = new DataView(wavHeader);\r\n\r\n      const pcmByteLength = samples.length * 2; // 16-bit = 2 bytes per sample\r\n\r\n      // \"RIFF\" chunk descriptor\r\n      view.setUint8(0, 'R'.charCodeAt(0));\r\n      view.setUint8(1, 'I'.charCodeAt(0));\r\n      view.setUint8(2, 'F'.charCodeAt(0));\r\n      view.setUint8(3, 'F'.charCodeAt(0));\r\n\r\n      // File length (header size + data size)\r\n      view.setUint32(4, 36 + pcmByteLength, true);\r\n\r\n      // \"WAVE\" format\r\n      view.setUint8(8, 'W'.charCodeAt(0));\r\n      view.setUint8(9, 'A'.charCodeAt(0));\r\n      view.setUint8(10, 'V'.charCodeAt(0));\r\n      view.setUint8(11, 'E'.charCodeAt(0));\r\n\r\n      // \"fmt \" sub-chunk\r\n      view.setUint8(12, 'f'.charCodeAt(0));\r\n      view.setUint8(13, 'm'.charCodeAt(0));\r\n      view.setUint8(14, 't'.charCodeAt(0));\r\n      view.setUint8(15, ' '.charCodeAt(0));\r\n\r\n      // Sub-chunk size\r\n      view.setUint32(16, 16, true);\r\n      // Audio format (PCM = 1)\r\n      view.setUint16(20, 1, true);\r\n      // Number of channels\r\n      view.setUint16(22, 1, true);\r\n      // Sample rate\r\n      view.setUint32(24, sampleRate, true);\r\n      // Byte rate\r\n      view.setUint32(28, sampleRate * 2, true);\r\n      // Block align\r\n      view.setUint16(32, 2, true);\r\n      // Bits per sample\r\n      view.setUint16(34, 16, true);\r\n\r\n      // \"data\" sub-chunk\r\n      view.setUint8(36, 'd'.charCodeAt(0));\r\n      view.setUint8(37, 'a'.charCodeAt(0));\r\n      view.setUint8(38, 't'.charCodeAt(0));\r\n      view.setUint8(39, 'a'.charCodeAt(0));\r\n\r\n      // Data size\r\n      view.setUint32(40, pcmByteLength, true);\r\n\r\n      // Create final buffer\r\n      const wavBuffer = new ArrayBuffer(wavHeader.byteLength + pcmByteLength);\r\n      const wavBytes = new Uint8Array(wavBuffer);\r\n\r\n      // Copy header and PCM data\r\n      wavBytes.set(new Uint8Array(wavHeader), 0);\r\n      wavBytes.set(new Uint8Array(samples.buffer), wavHeader.byteLength);\r\n\r\n      // Use Blob and FileReader to convert to base64\r\n      const blob = new Blob([wavBytes], { type: 'audio/wav' });\r\n      const reader = new FileReader();\r\n      reader.onloadend = () => {\r\n        const base64data = reader.result?.toString().split(',')[1];\r\n        if (base64data) {\r\n          resolve(base64data);\r\n        } else {\r\n          reject(new Error(\"Failed to convert WAV to base64\"));\r\n        }\r\n      };\r\n      reader.onerror = reject;\r\n      reader.readAsDataURL(blob);\r\n    } catch (error) {\r\n      reject(error);\r\n    }\r\n  });\r\n} "],"names":[],"mappings":"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"}},
    {"offset": {"line": 237, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 243, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ROG/gemini-nextjs/app/services/geminiWebSocket.ts"],"sourcesContent":["import { TranscriptionService } from \"./transcriptionService\";\r\nimport { pcmToWav } from \"../utils/audioUtils\";\r\n\r\nconst MODEL = \"models/gemini-2.0-flash-exp\";\r\nconst API_KEY = process.env.NEXT_PUBLIC_GEMINI_API_KEY;\r\nconst HOST = \"generativelanguage.googleapis.com\";\r\nconst WS_URL = `wss://${HOST}/ws/google.ai.generativelanguage.v1alpha.GenerativeService.BidiGenerateContent?key=${API_KEY}`;\r\n\r\nexport class GeminiWebSocket {\r\n  private ws: WebSocket | null = null;\r\n  private isConnected: boolean = false;\r\n  private isSetupComplete: boolean = false;\r\n  private onMessageCallback: ((text: string) => void) | null = null;\r\n  private onSetupCompleteCallback: (() => void) | null = null;\r\n  private audioContext: AudioContext | null = null;\r\n\r\n  // Audio queue management\r\n  private audioQueue: Float32Array[] = [];\r\n  private isPlaying: boolean = false;\r\n  private currentSource: AudioBufferSourceNode | null = null;\r\n  private isPlayingResponse: boolean = false;\r\n  private onPlayingStateChange: ((isPlaying: boolean) => void) | null = null;\r\n  private onAudioLevelChange: ((level: number) => void) | null = null;\r\n  private onTranscriptionCallback: ((text: string) => void) | null = null;\r\n  private transcriptionService: TranscriptionService;\r\n  private accumulatedPcmData: string[] = [];\r\n\r\n  constructor(\r\n    onMessage: (text: string) => void,\r\n    onSetupComplete: () => void,\r\n    onPlayingStateChange: (isPlaying: boolean) => void,\r\n    onAudioLevelChange: (level: number) => void,\r\n    onTranscription: (text: string) => void\r\n  ) {\r\n    this.onMessageCallback = onMessage;\r\n    this.onSetupCompleteCallback = onSetupComplete;\r\n    this.onPlayingStateChange = onPlayingStateChange;\r\n    this.onAudioLevelChange = onAudioLevelChange;\r\n    this.onTranscriptionCallback = onTranscription;\r\n    // Create AudioContext for playback\r\n    this.audioContext = new AudioContext({\r\n      sampleRate: 24000, // Match the response audio rate\r\n    });\r\n    this.transcriptionService = new TranscriptionService();\r\n  }\r\n\r\n  connect() {\r\n    if (this.ws?.readyState === WebSocket.OPEN) {\r\n      return;\r\n    }\r\n\r\n    this.ws = new WebSocket(WS_URL);\r\n\r\n    this.ws.onopen = () => {\r\n      this.isConnected = true;\r\n      this.sendInitialSetup();\r\n    };\r\n\r\n    this.ws.onmessage = async (event) => {\r\n      try {\r\n        let messageText: string;\r\n        if (event.data instanceof Blob) {\r\n          const arrayBuffer = await event.data.arrayBuffer();\r\n          const bytes = new Uint8Array(arrayBuffer);\r\n          messageText = new TextDecoder(\"utf-8\").decode(bytes);\r\n        } else {\r\n          messageText = event.data;\r\n        }\r\n\r\n        await this.handleMessage(messageText);\r\n      } catch (error) {\r\n        console.error(\"[WebSocket] Error processing message:\", error);\r\n      }\r\n    };\r\n\r\n    this.ws.onerror = (error) => {\r\n      console.error(\"[WebSocket] Error:\", error);\r\n    };\r\n\r\n    this.ws.onclose = (event) => {\r\n      this.isConnected = false;\r\n\r\n      // Only attempt to reconnect if we haven't explicitly called disconnect\r\n      if (!event.wasClean && this.isSetupComplete) {\r\n        setTimeout(() => this.connect(), 1000);\r\n      }\r\n    };\r\n  }\r\n\r\n  private sendInitialSetup() {\r\n    const setupMessage = {\r\n      setup: {\r\n        model: MODEL,\r\n        generation_config: {\r\n          response_modalities: [\"AUDIO\"],\r\n        },\r\n      },\r\n    };\r\n    this.ws?.send(JSON.stringify(setupMessage));\r\n  }\r\n\r\n  sendMediaChunk(b64Data: string, mimeType: string) {\r\n    if (!this.isConnected || !this.ws || !this.isSetupComplete) return;\r\n\r\n    const message = {\r\n      realtime_input: {\r\n        media_chunks: [\r\n          {\r\n            mime_type: mimeType === \"audio/pcm\" ? \"audio/pcm\" : mimeType,\r\n            data: b64Data,\r\n          },\r\n        ],\r\n      },\r\n    };\r\n\r\n    try {\r\n      this.ws.send(JSON.stringify(message));\r\n    } catch (error) {\r\n      console.error(\"[WebSocket] Error sending media chunk:\", error);\r\n    }\r\n  }\r\n\r\n  private async playAudioResponse(base64Data: string) {\r\n    if (!this.audioContext) return;\r\n\r\n    try {\r\n      // Decode base64 to bytes\r\n      const binaryString = atob(base64Data);\r\n      const bytes = new Uint8Array(binaryString.length);\r\n      for (let i = 0; i < binaryString.length; i++) {\r\n        bytes[i] = binaryString.charCodeAt(i);\r\n      }\r\n\r\n      // Convert to Int16Array (PCM format)\r\n      const pcmData = new Int16Array(bytes.buffer);\r\n\r\n      // Convert to float32 for Web Audio API\r\n      const float32Data = new Float32Array(pcmData.length);\r\n      for (let i = 0; i < pcmData.length; i++) {\r\n        float32Data[i] = pcmData[i] / 32768.0;\r\n      }\r\n\r\n      // Add to queue and start playing if not already playing\r\n      this.audioQueue.push(float32Data);\r\n      this.playNextInQueue();\r\n    } catch (error) {\r\n      console.error(\"[WebSocket] Error processing audio:\", error);\r\n    }\r\n  }\r\n\r\n  private async playNextInQueue() {\r\n    if (!this.audioContext || this.isPlaying || this.audioQueue.length === 0)\r\n      return;\r\n\r\n    try {\r\n      this.isPlaying = true;\r\n      this.isPlayingResponse = true;\r\n      this.onPlayingStateChange?.(true);\r\n      const float32Data = this.audioQueue.shift()!;\r\n\r\n      // Calculate audio level\r\n      let sum = 0;\r\n      for (let i = 0; i < float32Data.length; i++) {\r\n        sum += Math.abs(float32Data[i]);\r\n      }\r\n      const level = Math.min((sum / float32Data.length) * 100 * 5, 100);\r\n      this.onAudioLevelChange?.(level);\r\n\r\n      const audioBuffer = this.audioContext.createBuffer(\r\n        1,\r\n        float32Data.length,\r\n        24000\r\n      );\r\n      audioBuffer.getChannelData(0).set(float32Data);\r\n\r\n      this.currentSource = this.audioContext.createBufferSource();\r\n      this.currentSource.buffer = audioBuffer;\r\n      this.currentSource.connect(this.audioContext.destination);\r\n\r\n      this.currentSource.onended = () => {\r\n        this.isPlaying = false;\r\n        this.currentSource = null;\r\n        if (this.audioQueue.length === 0) {\r\n          this.isPlayingResponse = false;\r\n          this.onPlayingStateChange?.(false);\r\n        }\r\n        this.playNextInQueue();\r\n      };\r\n\r\n      this.currentSource.start();\r\n    } catch (error) {\r\n      console.error(\"[WebSocket] Error playing audio:\", error);\r\n      this.isPlaying = false;\r\n      this.isPlayingResponse = false;\r\n      this.onPlayingStateChange?.(false);\r\n      this.currentSource = null;\r\n      this.playNextInQueue();\r\n    }\r\n  }\r\n\r\n  private stopCurrentAudio() {\r\n    if (this.currentSource) {\r\n      try {\r\n        this.currentSource.stop();\r\n      } catch (e) {\r\n        // Ignore errors if already stopped\r\n      }\r\n      this.currentSource = null;\r\n    }\r\n    this.isPlaying = false;\r\n    this.isPlayingResponse = false;\r\n    this.onPlayingStateChange?.(false);\r\n    this.audioQueue = []; // Clear queue\r\n  }\r\n\r\n  private async handleMessage(message: string) {\r\n    try {\r\n      const messageData = JSON.parse(message);\r\n\r\n      if (messageData.setupComplete) {\r\n        this.isSetupComplete = true;\r\n        this.onSetupCompleteCallback?.();\r\n        return;\r\n      }\r\n\r\n      // Handle audio data\r\n      if (messageData.serverContent?.modelTurn?.parts) {\r\n        const parts = messageData.serverContent.modelTurn.parts;\r\n        for (const part of parts) {\r\n          if (part.inlineData?.mimeType === \"audio/pcm;rate=24000\") {\r\n            this.accumulatedPcmData.push(part.inlineData.data);\r\n            this.playAudioResponse(part.inlineData.data);\r\n          }\r\n        }\r\n      }\r\n\r\n      // Handle turn completion separately\r\n      if (messageData.serverContent?.turnComplete === true) {\r\n        if (this.accumulatedPcmData.length > 0) {\r\n          try {\r\n            const fullPcmData = this.accumulatedPcmData.join(\"\");\r\n            const wavData = await pcmToWav(fullPcmData, 24000);\r\n\r\n            const transcription =\r\n              await this.transcriptionService.transcribeAudio(\r\n                wavData,\r\n                \"audio/wav\"\r\n              );\r\n            console.log(\"[Transcription]:\", transcription);\r\n\r\n            this.onTranscriptionCallback?.(transcription);\r\n            this.accumulatedPcmData = []; // Clear accumulated data\r\n          } catch (error) {\r\n            console.error(\"[WebSocket] Transcription error:\", error);\r\n          }\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error(\"[WebSocket] Error parsing message:\", error);\r\n    }\r\n  }\r\n\r\n  disconnect() {\r\n    this.isSetupComplete = false;\r\n    if (this.ws) {\r\n      this.ws.close(1000, \"Intentional disconnect\");\r\n      this.ws = null;\r\n    }\r\n    this.isConnected = false;\r\n    this.accumulatedPcmData = [];\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 471, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 477, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ROG/gemini-nextjs/app/components/CameraPreview.tsx"],"sourcesContent":["// app/components/CameraPreview.tsx\r\n\"use client\";\r\n\r\nimport { useEffect, useRef, useState, useCallback } from \"react\";\r\nimport { Button } from \"../../components/ui/button\";\r\nimport { Video, VideoOff } from \"lucide-react\";\r\nimport { GeminiWebSocket } from \"../services/geminiWebSocket\";\r\nimport { Base64 } from \"js-base64\";\r\n\r\ninterface CameraPreviewProps {\r\n  onTranscription: (text: string) => void;\r\n}\r\n\r\nexport default function CameraPreview({ onTranscription }: CameraPreviewProps) {\r\n  const videoRef = useRef<HTMLVideoElement>(null);\r\n  const audioContextRef = useRef<AudioContext | null>(null);\r\n  const [isStreaming, setIsStreaming] = useState(false);\r\n  const [stream, setStream] = useState<MediaStream | null>(null);\r\n  const [audioLevel, setAudioLevel] = useState(0);\r\n  const geminiWsRef = useRef<GeminiWebSocket | null>(null);\r\n  const videoCanvasRef = useRef<HTMLCanvasElement>(null);\r\n  const audioWorkletNodeRef = useRef<AudioWorkletNode | null>(null);\r\n  const [isAudioSetup, setIsAudioSetup] = useState(false);\r\n  const setupInProgressRef = useRef(false);\r\n  const [isWebSocketReady, setIsWebSocketReady] = useState(false);\r\n  const imageIntervalRef = useRef<NodeJS.Timeout | null>(null);\r\n  const [isModelSpeaking, setIsModelSpeaking] = useState(false);\r\n  const [outputAudioLevel, setOutputAudioLevel] = useState(0);\r\n  const [connectionStatus, setConnectionStatus] = useState<\r\n    \"disconnected\" | \"connecting\" | \"connected\"\r\n  >(\"disconnected\");\r\n\r\n  // NEW: Error state for user feedback\r\n  const [mediaError, setMediaError] = useState<string | null>(null);\r\n\r\n  const cleanupAudio = useCallback(() => {\r\n    if (audioWorkletNodeRef.current) {\r\n      audioWorkletNodeRef.current.disconnect();\r\n      audioWorkletNodeRef.current = null;\r\n    }\r\n    if (audioContextRef.current) {\r\n      audioContextRef.current.close();\r\n      audioContextRef.current = null;\r\n    }\r\n  }, []);\r\n\r\n  const cleanupWebSocket = useCallback(() => {\r\n    if (geminiWsRef.current) {\r\n      geminiWsRef.current.disconnect();\r\n      geminiWsRef.current = null;\r\n    }\r\n  }, []);\r\n\r\n  // Simplify sendAudioData to just send continuously\r\n  const sendAudioData = (b64Data: string) => {\r\n    if (!geminiWsRef.current) return;\r\n    geminiWsRef.current.sendMediaChunk(b64Data, \"audio/pcm\");\r\n  };\r\n\r\n  // Improved toggleCamera with error handling\r\n  const toggleCamera = async () => {\r\n    if (isStreaming && stream) {\r\n      setIsStreaming(false);\r\n      cleanupWebSocket();\r\n      cleanupAudio();\r\n      stream.getTracks().forEach((track) => track.stop());\r\n      if (videoRef.current) {\r\n        videoRef.current.srcObject = null;\r\n      }\r\n      setStream(null);\r\n      setMediaError(null); // Clear error when stopping\r\n    } else {\r\n      try {\r\n        setMediaError(null); // Clear previous errors\r\n\r\n        // Check for available devices first\r\n        const devices = await navigator.mediaDevices.enumerateDevices();\r\n        const hasVideo = devices.some((d) => d.kind === \"videoinput\");\r\n        const hasAudio = devices.some((d) => d.kind === \"audioinput\");\r\n        if (!hasVideo && !hasAudio) {\r\n          setMediaError(\"No camera or microphone found.\");\r\n          return;\r\n        } else if (!hasVideo) {\r\n          setMediaError(\"No camera found.\");\r\n          return;\r\n        } else if (!hasAudio) {\r\n          setMediaError(\"No microphone found.\");\r\n          return;\r\n        }\r\n\r\n        // Combine audio and video constraints in a single call\r\n        const combinedStream = await navigator.mediaDevices.getUserMedia({\r\n          video: true,\r\n          audio: {\r\n            echoCancellation: true,\r\n            noiseSuppression: true,\r\n            autoGainControl: true,\r\n          },\r\n        });\r\n\r\n        audioContextRef.current = new AudioContext({\r\n          sampleRate: 16000,\r\n        });\r\n\r\n        if (videoRef.current) {\r\n          videoRef.current.srcObject = combinedStream;\r\n          videoRef.current.muted = true;\r\n        }\r\n\r\n        setStream(combinedStream);\r\n        setIsStreaming(true);\r\n      } catch (err: any) {\r\n        console.error(\"Error accessing media devices:\", err);\r\n        cleanupAudio();\r\n\r\n        // Handle NotFoundError\r\n        if (err && err.name === \"NotFoundError\") {\r\n          setMediaError(\r\n            \"No camera or microphone found. Please connect a device and try again.\"\r\n          );\r\n        } else if (err && err.name === \"NotAllowedError\") {\r\n          setMediaError(\r\n            \"Permission denied. Please allow camera and microphone access.\"\r\n          );\r\n        } else {\r\n          setMediaError(\r\n            \"Could not access camera or microphone. Please check your device and browser settings.\"\r\n          );\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  // Initialize WebSocket connection\r\n  useEffect(() => {\r\n    if (!isStreaming) {\r\n      setConnectionStatus(\"disconnected\");\r\n      return;\r\n    }\r\n\r\n    setConnectionStatus(\"connecting\");\r\n    geminiWsRef.current = new GeminiWebSocket(\r\n      (text) => {\r\n        console.log(\"Received from Gemini:\", text);\r\n      },\r\n      () => {\r\n        console.log(\r\n          \"[Camera] WebSocket setup complete, starting media capture\"\r\n        );\r\n        setIsWebSocketReady(true);\r\n        setConnectionStatus(\"connected\");\r\n      },\r\n      (isPlaying) => {\r\n        setIsModelSpeaking(isPlaying);\r\n      },\r\n      (level) => {\r\n        setOutputAudioLevel(level);\r\n      },\r\n      onTranscription\r\n    );\r\n    geminiWsRef.current.connect();\r\n\r\n    return () => {\r\n      if (imageIntervalRef.current) {\r\n        clearInterval(imageIntervalRef.current);\r\n        imageIntervalRef.current = null;\r\n      }\r\n      cleanupWebSocket();\r\n      setIsWebSocketReady(false);\r\n      setConnectionStatus(\"disconnected\");\r\n    };\r\n  }, [isStreaming, onTranscription, cleanupWebSocket]);\r\n\r\n  // Start image capture only after WebSocket is ready\r\n  useEffect(() => {\r\n    if (!isStreaming || !isWebSocketReady) return;\r\n\r\n    console.log(\"[Camera] Starting image capture interval\");\r\n    imageIntervalRef.current = setInterval(captureAndSendImage, 1000);\r\n\r\n    return () => {\r\n      if (imageIntervalRef.current) {\r\n        clearInterval(imageIntervalRef.current);\r\n        imageIntervalRef.current = null;\r\n      }\r\n    };\r\n  }, [isStreaming, isWebSocketReady]);\r\n\r\n  // Update audio processing setup\r\n  useEffect(() => {\r\n    if (\r\n      !isStreaming ||\r\n      !stream ||\r\n      !audioContextRef.current ||\r\n      !isWebSocketReady ||\r\n      isAudioSetup ||\r\n      setupInProgressRef.current\r\n    )\r\n      return;\r\n\r\n    let isActive = true;\r\n    setupInProgressRef.current = true;\r\n\r\n    const setupAudioProcessing = async () => {\r\n      try {\r\n        const ctx = audioContextRef.current;\r\n        if (!ctx || ctx.state === \"closed\" || !isActive) {\r\n          setupInProgressRef.current = false;\r\n          return;\r\n        }\r\n\r\n        if (ctx.state === \"suspended\") {\r\n          await ctx.resume();\r\n        }\r\n\r\n        await ctx.audioWorklet.addModule(\"/worklets/audio-processor.js\");\r\n\r\n        if (!isActive) {\r\n          setupInProgressRef.current = false;\r\n          return;\r\n        }\r\n\r\n        audioWorkletNodeRef.current = new AudioWorkletNode(\r\n          ctx,\r\n          \"audio-processor\",\r\n          {\r\n            numberOfInputs: 1,\r\n            numberOfOutputs: 1,\r\n            processorOptions: {\r\n              sampleRate: 16000,\r\n              bufferSize: 4096, // Larger buffer size like original\r\n            },\r\n            channelCount: 1,\r\n            channelCountMode: \"explicit\",\r\n            channelInterpretation: \"speakers\",\r\n          }\r\n        );\r\n\r\n        const source = ctx.createMediaStreamSource(stream);\r\n        audioWorkletNodeRef.current.port.onmessage = (event) => {\r\n          if (!isActive || isModelSpeaking) return;\r\n          const { pcmData, level } = event.data;\r\n          setAudioLevel(level);\r\n\r\n          const pcmArray = new Uint8Array(pcmData);\r\n          const b64Data = Base64.fromUint8Array(pcmArray);\r\n          sendAudioData(b64Data);\r\n        };\r\n\r\n        source.connect(audioWorkletNodeRef.current);\r\n        setIsAudioSetup(true);\r\n        setupInProgressRef.current = false;\r\n\r\n        return () => {\r\n          source.disconnect();\r\n          if (audioWorkletNodeRef.current) {\r\n            audioWorkletNodeRef.current.disconnect();\r\n          }\r\n          setIsAudioSetup(false);\r\n        };\r\n      } catch (error) {\r\n        if (isActive) {\r\n          cleanupAudio();\r\n          setIsAudioSetup(false);\r\n        }\r\n        setupInProgressRef.current = false;\r\n      }\r\n    };\r\n\r\n    console.log(\"[Camera] Starting audio processing setup\");\r\n    setupAudioProcessing();\r\n\r\n    return () => {\r\n      isActive = false;\r\n      setIsAudioSetup(false);\r\n      setupInProgressRef.current = false;\r\n      if (audioWorkletNodeRef.current) {\r\n        audioWorkletNodeRef.current.disconnect();\r\n        audioWorkletNodeRef.current = null;\r\n      }\r\n    };\r\n  }, [isStreaming, stream, isWebSocketReady, isModelSpeaking]);\r\n\r\n  // Capture and send image\r\n  const captureAndSendImage = () => {\r\n    if (!videoRef.current || !videoCanvasRef.current || !geminiWsRef.current)\r\n      return;\r\n\r\n    const canvas = videoCanvasRef.current;\r\n    const context = canvas.getContext(\"2d\");\r\n    if (!context) return;\r\n\r\n    // Set canvas size to match video\r\n    canvas.width = videoRef.current.videoWidth;\r\n    canvas.height = videoRef.current.videoHeight;\r\n\r\n    // Draw video frame to canvas\r\n    context.drawImage(videoRef.current, 0, 0);\r\n\r\n    // Convert to base64 and send\r\n    const imageData = canvas.toDataURL(\"image/jpeg\", 0.8);\r\n    const b64Data = imageData.split(\",\")[1];\r\n    geminiWsRef.current.sendMediaChunk(b64Data, \"image/jpeg\");\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {/* Show error if present */}\r\n      {mediaError && (\r\n        <div className=\"mb-2 text-red-600 text-center font-semibold\">\r\n          {mediaError}\r\n        </div>\r\n      )}\r\n      <div className=\"relative\">\r\n        <video\r\n          ref={videoRef}\r\n          autoPlay\r\n          playsInline\r\n          className=\"w-[640px] h-[480px] bg-muted rounded-lg overflow-hidden\"\r\n        />\r\n        {/* Connection Status Overlay */}\r\n        {isStreaming && connectionStatus !== \"connected\" && (\r\n          <div className=\"absolute inset-0 bg-black/50 flex items-center justify-center rounded-lg backdrop-blur-sm\">\r\n            <div className=\"text-center space-y-2\">\r\n              <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-white mx-auto\" />\r\n              <p className=\"text-white font-medium\">\r\n                {connectionStatus === \"connecting\"\r\n                  ? \"Connecting to Gemini...\"\r\n                  : \"Disconnected\"}\r\n              </p>\r\n              <p className=\"text-white/70 text-sm\">\r\n                Please wait while we establish a secure connection\r\n              </p>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <Button\r\n          onClick={toggleCamera}\r\n          size=\"icon\"\r\n          className={`absolute left-1/2 bottom-4 -translate-x-1/2 rounded-full w-12 h-12 backdrop-blur-sm transition-colors\r\n            ${\r\n              isStreaming\r\n                ? \"bg-red-500/50 hover:bg-red-500/70 text-white\"\r\n                : \"bg-green-500/50 hover:bg-green-500/70 text-white\"\r\n            }`}\r\n        >\r\n          {isStreaming ? (\r\n            <VideoOff className=\"h-6 w-6\" />\r\n          ) : (\r\n            <Video className=\"h-6 w-6\" />\r\n          )}\r\n        </Button>\r\n      </div>\r\n      {isStreaming && (\r\n        <div className=\"w-[640px] h-2 rounded-full bg-green-100\">\r\n          <div\r\n            className=\"h-full rounded-full transition-all bg-green-500\"\r\n            style={{\r\n              width: `${isModelSpeaking ? outputAudioLevel : audioLevel}%`,\r\n              transition: \"width 100ms ease-out\",\r\n            }}\r\n          />\r\n        </div>\r\n      )}\r\n      <canvas ref={videoCanvasRef} className=\"hidden\" />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 859, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 865, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ROG/gemini-nextjs/components/ui/scroll-area.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst ScrollArea = React.forwardRef<\r\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\r\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\r\n>(({ className, children, ...props }, ref) => (\r\n  <ScrollAreaPrimitive.Root\r\n    ref={ref}\r\n    className={cn(\"relative overflow-hidden\", className)}\r\n    {...props}\r\n  >\r\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\r\n      {children}\r\n    </ScrollAreaPrimitive.Viewport>\r\n    <ScrollBar />\r\n    <ScrollAreaPrimitive.Corner />\r\n  </ScrollAreaPrimitive.Root>\r\n))\r\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\r\n\r\nconst ScrollBar = React.forwardRef<\r\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\r\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\r\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\r\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\r\n    ref={ref}\r\n    orientation={orientation}\r\n    className={cn(\r\n      \"flex touch-none select-none transition-colors\",\r\n      orientation === \"vertical\" &&\r\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\r\n      orientation === \"horizontal\" &&\r\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\r\n      className\r\n    )}\r\n    {...props}\r\n  >\r\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\r\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\r\n))\r\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\r\n\r\nexport { ScrollArea, ScrollBar }\r\n"],"names":[],"mappings":";;;;;AAEA;AAGA;AAFA;AAHA;;;;;AAOA,MAAM,2BAAa,sMAAM,UAAU,CAGjC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,8OAAC,2KAAoB,IAAI;QACvB,KAAK;QACL,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EAAE,4BAA4B;QACzC,GAAG,KAAK;;0BAET,8OAAC,2KAAoB,QAAQ;gBAAC,WAAU;0BACrC;;;;;;0BAEH,8OAAC;;;;;0BACD,8OAAC,2KAAoB,MAAM;;;;;;;;;;;AAG/B,WAAW,WAAW,GAAG,2KAAoB,IAAI,CAAC,WAAW;AAE7D,MAAM,0BAAY,sMAAM,UAAU,CAGhC,CAAC,EAAE,SAAS,EAAE,cAAc,UAAU,EAAE,GAAG,OAAO,EAAE,oBACpD,8OAAC,2KAAoB,mBAAmB;QACtC,KAAK;QACL,aAAa;QACb,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EACV,iDACA,gBAAgB,cACd,sDACF,gBAAgB,gBACd,wDACF;QAED,GAAG,KAAK;kBAET,cAAA,8OAAC,2KAAoB,eAAe;YAAC,WAAU;;;;;;;;;;;AAGnD,UAAU,WAAW,GAAG,2KAAoB,mBAAmB,CAAC,WAAW"}},
    {"offset": {"line": 927, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 933, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ROG/gemini-nextjs/components/ui/avatar.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst Avatar = React.forwardRef<\r\n  React.ElementRef<typeof AvatarPrimitive.Root>,\r\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\r\n>(({ className, ...props }, ref) => (\r\n  <AvatarPrimitive.Root\r\n    ref={ref}\r\n    className={cn(\r\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nAvatar.displayName = AvatarPrimitive.Root.displayName\r\n\r\nconst AvatarImage = React.forwardRef<\r\n  React.ElementRef<typeof AvatarPrimitive.Image>,\r\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\r\n>(({ className, ...props }, ref) => (\r\n  <AvatarPrimitive.Image\r\n    ref={ref}\r\n    className={cn(\"aspect-square h-full w-full\", className)}\r\n    {...props}\r\n  />\r\n))\r\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\r\n\r\nconst AvatarFallback = React.forwardRef<\r\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\r\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\r\n>(({ className, ...props }, ref) => (\r\n  <AvatarPrimitive.Fallback\r\n    ref={ref}\r\n    className={cn(\r\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\r\n\r\nexport { Avatar, AvatarImage, AvatarFallback }\r\n"],"names":[],"mappings":";;;;;;AAEA;AAGA;AAFA;AAHA;;;;;AAOA,MAAM,uBAAS,sMAAM,UAAU,CAG7B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,mKAAgB,IAAI;QACnB,KAAK;QACL,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EACV,iEACA;QAED,GAAG,KAAK;;;;;;AAGb,OAAO,WAAW,GAAG,mKAAgB,IAAI,CAAC,WAAW;AAErD,MAAM,4BAAc,sMAAM,UAAU,CAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,mKAAgB,KAAK;QACpB,KAAK;QACL,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EAAE,+BAA+B;QAC5C,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG,mKAAgB,KAAK,CAAC,WAAW;AAE3D,MAAM,+BAAiB,sMAAM,UAAU,CAGrC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,mKAAgB,QAAQ;QACvB,KAAK;QACL,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EACV,wEACA;QAED,GAAG,KAAK;;;;;;AAGb,eAAe,WAAW,GAAG,mKAAgB,QAAQ,CAAC,WAAW"}},
    {"offset": {"line": 978, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 984, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ROG/gemini-nextjs/app/page.tsx"],"sourcesContent":["// app/page.tsx\r\n\"use client\";\r\nimport { useState, useCallback } from 'react';\r\nimport CameraPreview from './components/CameraPreview';\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { Avatar, AvatarImage, AvatarFallback } from \"@/components/ui/avatar\";\r\n\r\n// Helper function to create message components\r\nconst HumanMessage = ({ text }: { text: string }) => (\r\n  <div className=\"flex gap-3 items-start\">\r\n    <Avatar className=\"h-8 w-8\">\r\n      <AvatarImage src=\"/avatars/human.png\" alt=\"Human\" />\r\n      <AvatarFallback>H</AvatarFallback>\r\n    </Avatar>\r\n    <div className=\"flex-1 space-y-2\">\r\n      <div className=\"flex items-center gap-2\">\r\n        <p className=\"text-sm font-medium text-zinc-900\">You</p>\r\n      </div>\r\n      <div className=\"rounded-lg bg-zinc-100 px-3 py-2 text-sm text-zinc-800\">\r\n        {text}\r\n      </div>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nconst GeminiMessage = ({ text }: { text: string }) => (\r\n  <div className=\"flex gap-3 items-start\">\r\n    <Avatar className=\"h-8 w-8 bg-blue-600\">\r\n      <AvatarImage src=\"/avatars/gemini.png\" alt=\"Gemini\" />\r\n      <AvatarFallback>AI</AvatarFallback>\r\n    </Avatar>\r\n    <div className=\"flex-1 space-y-2\">\r\n      <div className=\"flex items-center gap-2\">\r\n        <p className=\"text-sm font-medium text-zinc-900\">Gemini</p>\r\n      </div>\r\n      <div className=\"rounded-lg bg-white border border-zinc-200 px-3 py-2 text-sm text-zinc-800\">\r\n        {text}\r\n      </div>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nexport default function Home() {\r\n  const [messages, setMessages] = useState<{ type: 'human' | 'gemini', text: string }[]>([]);\r\n\r\n  const handleTranscription = useCallback((transcription: string) => {\r\n    setMessages(prev => [...prev, { type: 'gemini', text: transcription }]);\r\n  }, []);\r\n\r\n  return (\r\n    <>\r\n      <h1 className=\"text-4xl font-bold text-zinc-800 p-8 pb-0\">\r\n        Multimodal Live Chat\r\n      </h1>\r\n      <div className=\"flex gap-8 p-8\">\r\n        <CameraPreview onTranscription={handleTranscription} />\r\n\r\n        <div className=\"w-[640px] bg-white\">\r\n          <ScrollArea className=\"h-[540px] p-6\">\r\n            <div className=\"space-y-6\">\r\n              <GeminiMessage text=\"Hi! I'm Gemini. I can see and hear you. Let's chat!\" />\r\n              {messages.map((message, index) => (\r\n                message.type === 'human' ? (\r\n                  <HumanMessage key={`msg-${index}`} text={message.text} />\r\n                ) : (\r\n                  <GeminiMessage key={`msg-${index}`} text={message.text} />\r\n                )\r\n              ))}\r\n            </div>\r\n          </ScrollArea>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,eAAe;;;;;AAEf;AACA;AACA;AACA;AAJA;;;;;;AAMA,+CAA+C;AAC/C,MAAM,eAAe,CAAC,EAAE,IAAI,EAAoB,iBAC9C,8OAAC;QAAI,WAAU;;0BACb,8OAAC,2HAAA,CAAA,SAAM;gBAAC,WAAU;;kCAChB,8OAAC,2HAAA,CAAA,cAAW;wBAAC,KAAI;wBAAqB,KAAI;;;;;;kCAC1C,8OAAC,2HAAA,CAAA,iBAAc;kCAAC;;;;;;;;;;;;0BAElB,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BAAE,WAAU;sCAAoC;;;;;;;;;;;kCAEnD,8OAAC;wBAAI,WAAU;kCACZ;;;;;;;;;;;;;;;;;;AAMT,MAAM,gBAAgB,CAAC,EAAE,IAAI,EAAoB,iBAC/C,8OAAC;QAAI,WAAU;;0BACb,8OAAC,2HAAA,CAAA,SAAM;gBAAC,WAAU;;kCAChB,8OAAC,2HAAA,CAAA,cAAW;wBAAC,KAAI;wBAAsB,KAAI;;;;;;kCAC3C,8OAAC,2HAAA,CAAA,iBAAc;kCAAC;;;;;;;;;;;;0BAElB,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BAAE,WAAU;sCAAoC;;;;;;;;;;;kCAEnD,8OAAC;wBAAI,WAAU;kCACZ;;;;;;;;;;;;;;;;;;AAMM,SAAS;IACtB,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAgD,EAAE;IAEzF,MAAM,sBAAsB,CAAA,GAAA,qMAAA,CAAA,cAAW,AAAD,EAAE,CAAC;QACvC,YAAY,CAAA,OAAQ;mBAAI;gBAAM;oBAAE,MAAM;oBAAU,MAAM;gBAAc;aAAE;IACxE,GAAG,EAAE;IAEL,qBACE;;0BACE,8OAAC;gBAAG,WAAU;0BAA4C;;;;;;0BAG1D,8OAAC;gBAAI,WAAU;;kCACb,8OAAC,mIAAA,CAAA,UAAa;wBAAC,iBAAiB;;;;;;kCAEhC,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC,mIAAA,CAAA,aAAU;4BAAC,WAAU;sCACpB,cAAA,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAc,MAAK;;;;;;oCACnB,SAAS,GAAG,CAAC,CAAC,SAAS,QACtB,QAAQ,IAAI,KAAK,wBACf,8OAAC;4CAAkC,MAAM,QAAQ,IAAI;2CAAlC,CAAC,IAAI,EAAE,OAAO;;;;iEAEjC,8OAAC;4CAAmC,MAAM,QAAQ,IAAI;2CAAlC,CAAC,IAAI,EAAE,OAAO;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASpD"}},
    {"offset": {"line": 1213, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}